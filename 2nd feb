Filter - Decommissioning Apps = 
VAR SelectedYear = SELECTEDVALUE(YearParameter[Year])

RETURN
FILTER(
    'Decommissioning Apps',
    YEAR('Decommissioning Apps'[Forecast End Date]) = SelectedYear &&
    'Decommissioning Apps'[Phase] = "Completed"
)


D = 
CALCULATE(
    COUNTROWS('Filter - Decommissioning Apps'),
    FILTER(
        'Filter - Decommissioning Apps',
        'Filter - Decommissioning Apps'[ID_4] = 'IT Architecture'[ID]
    )
)


DCount = SUM('IT Architecture'[D])+0




Architecture Count = 
VAR YearIsSel = HASONEVALUE('Calendar'[Year])
VAR MonthIsSel = HASONEVALUE('Calendar'[Month])

/* Pick a single target date based on slicers */
VAR TargetDate = 
    IF(
        MonthIsSel,
        CALCULATE(
            MAX('IT Architecture'[Date extracted]),  // Replace with your actual date column name
            ALLEXCEPT('Calendar', 'Calendar'[Year], 'Calendar'[Month])
        ),
        IF(
            YearIsSel,
            CALCULATE(
                MAX('IT Architecture'[Date extracted]),
                ALLEXCEPT('Calendar', 'Calendar'[Year])
            ),
            CALCULATE(
                MAX('IT Architecture'[Date extracted]),
                ALL('IT Architecture')
            )
        )
    )

RETURN
IF(
    ISBLANK(TargetDate),
    0,
    VAR StartOfMonth = DATE(YEAR(TargetDate), MONTH(TargetDate), 1)
    VAR EndOfMonth = EOMONTH(TargetDate, 0)
    VAR Result_ = 
        CALCULATE(
            COUNTROWS('IT Architecture'),  // Or SUM of a specific column if needed
            KEEPFILTERS('IT Architecture'[Phase] = "Completed"),  // Add your filter condition
            DATESBETWEEN('Calendar'[Date], StartOfMonth, EndOfMonth)
        )
    RETURN COALESCE(Result_, 0)
)
