NCount_new = 
VAR YearIsSel  = HASONEVALUE('Calendar'[Year])
VAR MonthIsSel = HASONEVALUE('Calendar'[Month])
 
/* Determine a single anchor date from slicers */
VAR TargetDate =
    IF(
        MonthIsSel,
        CALCULATE(
            MAX('Calendar'[Date]),
            ALLEXCEPT('Calendar', 'Calendar'[Year], 'Calendar'[Month])
        ),
        IF(
            YearIsSel,
            CALCULATE(
                MAX('Calendar'[Date]),
                ALLEXCEPT('Calendar', 'Calendar'[Year])
            ),
            CALCULATE( MAX('Calendar'[Date]), ALL('Calendar') )
        )
    )
 
/* December exception window vs. normal window */
VAR IsDecemberSelection = MonthIsSel && MONTH(TargetDate) = 12
 
VAR WindowStart =
    IF(
        IsDecemberSelection,
        DATE(YEAR(TargetDate), 12, 1),
        EOMONTH(TargetDate, 0) + 1
    )
 
VAR WindowEnd =
    IF(
        IsDecemberSelection,
        DATE(YEAR(TargetDate), 12, 31),
        DATE(YEAR(WindowStart), 12, 31)
    )
 
RETURN
IF(
    ISBLANK(TargetDate),
    0,
    CALCULATE(
        COUNTROWS('IT Architecture'),
        TREATAS(
            DATESBETWEEN('Calendar'[Date], WindowStart, WindowEnd),
            'IT Architecture'[Valid From]
        )
    )
)+0

----------------------------------------------

NCount_prevmonth =
VAR YearIsSel  = HASONEVALUE('Calendar'[Year])
VAR MonthIsSel = HASONEVALUE('Calendar'[Month])

/* Determine a single anchor date from slicers (your original behavior) */
VAR TargetDate =
    IF(
        MonthIsSel,
        CALCULATE(
            MAX('Calendar'[Date]),
            ALLEXCEPT('Calendar', 'Calendar'[Year], 'Calendar'[Month])
        ),
        IF(
            YearIsSel,
            CALCULATE(
                MAX('Calendar'[Date]),
                ALLEXCEPT('Calendar', 'Calendar'[Year])
            ),
            CALCULATE( MAX('Calendar'[Date]), ALL('Calendar') )
        )
    )

/* Shift to PREVIOUS month (this is the key change) */
VAR PrevMonthAnchor = EOMONTH(TargetDate, -1)
VAR PrevMonthStart  = DATE(YEAR(PrevMonthAnchor), MONTH(PrevMonthAnchor), 1)
VAR PrevMonthEnd    = EOMONTH(PrevMonthAnchor, 0)

/* Valid From window:
   - If previous month is December → Dec 1 to Dec 31 (same year)
   - Else → PrevMonthStart to Dec 31 of that same year
*/
VAR WindowStart = PrevMonthStart
VAR WindowEnd   =
    IF(
        MONTH(PrevMonthAnchor) = 12,
        DATE(YEAR(PrevMonthAnchor), 12, 31),
        DATE(YEAR(PrevMonthStart), 12, 31)
    )

RETURN
IF(
    ISBLANK(TargetDate),
    0,
    CALCULATE(
        COUNTROWS('IT Architecture'),

        /* (1) Filter Date extracted to the PREVIOUS month */
        TREATAS(
            DATESBETWEEN('Calendar'[Date], PrevMonthStart, PrevMonthEnd),
            'IT Architecture'[Date extracted]
        ),

        /* (2) Filter Valid From to your Excel window */
        TREATAS(
            DATESBETWEEN('Calendar'[Date], WindowStart, WindowEnd),
            'IT Architecture'[Valid From]
        )
    )
) + 0
